<!DOCTYPE html>
<html>

  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <style>
      .label-field {
        width: 120px;
      }
      .drop-down{
        display: block;
        margin: 0 auto;
      }
      
    </style>
    
    <script type="text/javascript">
    
      function saveProperties() {
        var rowValue = document.getElementById("rowNumber").value;
        var categoryValue = document.getElementById("category").value;
        var precisionValue = document.getElementById("precision").value;
        var noteValue = document.getElementById("note").value;

        google.script.run.saveUserProperties(rowValue, categoryValue, precisionValue, noteValue);
        
        google.script.host.close();
      }
      function loadProperties() {
        google.script.run.withSuccessHandler(setProperties).getWindowProperties();
      }
      function setProperties(vals) {
        if(typeof vals.row !== "undefined") {
           document.getElementById("rowNumber").value = vals.row;
        }
        if(typeof vals.category !== "undefined") {
           document.getElementById("category").value = vals.category;
        }        
        if(typeof vals.precision !== "undefined") {
           document.getElementById("precision").value = vals.precision;
        }
        if(typeof vals.note !== "undefined") {
           document.getElementById("note").value = vals.note;
        }
      }
    </script>
  </head>
 
  <body>   
  <div class="sidebar branding-below">
   <div id="oppBlock" style="">
   <h1 id='oppTitle'>Take A Note</h1>
   <br>
   <h3 id='rowTitle'>Add Note to Which Row?</h3>
   <table>
    <tr>
     <td class="label-field">
      <label for="row">Row</label>
     </td>
     <td>
      <input type="number" id="rowNumber" autocomplete="off">
     </td>
    </tr>
   </table>
   <br>
   <h3 id='noteTitle'>Note</h3>
   <table>
    <tr>
     <td class="label-field">
      <label for="category">Category</label>
     </td>
     <td>
      <select class="drop-down" name="category" id="category">
       <option value="1">Revenue</option>
       <option value="2">Bookings</option>
       <option value="3">PMO</option>
       <option value="4">Operations</option>
       <option value="5">RMO</option>
      </select>
     </td>
    </tr>
    <tr>
     <td class="label-field">
      <label for="precision">Precision</label>
     </td>
     <td>
      <select class="drop-down" name="precision" id="precision">
       <option value="1">Normal</option>
       <option value="2">High-level Summary</option>
       <option value="3">Low-level Details</option>
      </select>
     </td>
    </tr>
    <tr>
     <td class="label-field">
      <label for="note">Note</label>
     </td>
     <td>
      <textarea id="note" rows="6" cols="24"></textarea>
     </td>
    </tr>
   </table>
    <div class="block">
      <button style="width:100%;" class="green" id ="saveButton" onClick="saveProperties()">Save</button>
    </div>
    </div>
    </div>
  </body>
  
</html>


